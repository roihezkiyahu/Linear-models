---
title: "EX4"
author: "roi hezkiyahu"
date: "27 4 2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# imports
library(tidyverse)
library(glue)
install.packages("nlme")
library(nlme)
```

# Q1

![](Q1.png)

$$
y_i|y_{i-1} \sim N(\rho y_{i-1},\sigma^2) \textrm{ as a sum of normal variables}
\\
f(y_i|y_{i-1}) = \frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{(y_i-\rho y_{i-1})^2}{2\sigma^2}}
\\
L(\rho,\sigma^2) = f(y_1,\ldots,y_n) = f(y_n|y_{n-1},\ldots,y_0)f(y_{n-1},\ldots,y_0) = \ldots = \Pi_{i=1}^nf(y_i|y_{i-1},\ldots y_0)f(y_0) = \Pi_{i=1}^nf(y_i|y_{i-1},\ldots,y_0) 
\\
\textrm{notice that: } f(y_i|y_{i-1},\ldots,y_0) = f(y_i|y_{i-1}) \textrm{ thus we get:}
\\
L(\rho,\sigma^2) = \Pi_{i=1}^nf(y_i|y_{i-1}) = \Pi_{i=1}^n \frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{(y_i-\rho y_{i-1})^2}{2\sigma^2}}
\\
l(\rho,\sigma^2) = Log(L(\rho,\sigma^2)) = \sum_{i=1}^n ln(\frac{1}{\sqrt{2\pi \sigma^2}}e^{-\frac{(y_i-\rho y_{i-1})^2}{2\sigma^2}}) = 
C + n ln(\sigma)-\sum_{i=1}^n(\frac{(y_i-\rho y_{i-1})^2}{2\sigma^2})
\\
\frac{\partial l}{\partial \rho} = \frac{1}{2\sigma^2}\sum_{i=1}^n 2 y_iy_{i-1}-2\rho y_{i-1}^2 := 0 \Rightarrow \hat \rho_{MLE} = \frac{\sum_{i=1}^n y_iy_{i-1}}{\sum_{i=1}^ny_{i-1}^2}
\\
\frac{\partial l}{\partial \sigma} = \frac{n}{\sigma} - \sum_{i=1}^n\frac{(y_i-\rho y_{i-1})^2}{\sigma^3} = \frac{n \sigma^2 - \sum_{i=1}^n(\varepsilon_i^2)}{\sigma^3} :=0 \Rightarrow \hat\sigma^2_{MLE} = \frac{\sum_{i=1}^n(\hat \varepsilon_i^2)}{n} ; \hat \varepsilon_i = y_i - \hat \rho_{MLE}y_{i-1}
$$


# Q2

![](Q2.png)




# Q3

![](Q3.png)
